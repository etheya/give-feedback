{% extends "layout.html" %}

{% block page_title %}
  Exit survey
{% endblock %}

{% block content %}

<main id="content" role="main">
    
    {% include "includes/phase_banner_alpha.html" %}

        <div id="error-summary" class="error-summary" role="group" aria-labelledby="error-summary-heading-example-1" tabindex="-1" style="display:none">

            <h1 class="heading-medium error-summary-heading" id="error-summary-heading-example-1">
                There is a problem
            </h1>

            <ul class="error-summary-list text">
                <li id="done-error-link"><a href="#done-yes">Select yes if you were able to do what you needed to</a></li>
                <li id="what-error-link"><a href="#what">Enter what you were trying to do and why you were not able to do it</a></li>
            </ul>

        </div>

        <div class="grid-row">

            <div class="column-two-thirds">

            <a class="link-back" href="javascript:history.go(-1)">Back</a>                                

                <h1 class="heading-large">
                    Give feedback
                </h1>

                <p>
                    Do not include any personal or financial information like your National Insurance number or bank details.
                </p>

                <form role="form" class="form" action="exit2">            

                    <fieldset class="inline">                    

                        <div class="form-group" id="done-yes-no">
                        <legend class="form-label-bold">
                            Were you able to do what you needed to do today?
                        </legend>

                        <span id="done-error" class="error-message" style="display:none">Select yes if you were able to do what you needed to</span>

                        <label class="block-label" for="done-yes">
                            <input id="done-yes" type="radio" name="done" value="Yes" aria-required="true">Yes
                        </label>

                        <label class="block-label" for="done-no" data-target="what-panel">
                            <input id="done-no" type="radio" name="done" value="No" aria-required="true">No
                        </label>                        

                        <div class="form-group panel panel-border-narrow js-hidden" id="what-panel">                            
                            <label class="form-label-bold" for="what" aria-required="true">
                                What were you trying to do and why were you not able to do it?
                            </label>
                            <span id="what-error" class="error-message" style="display:none">Enter what you were trying to do and why you were not able to do it</span>
                            <textarea class="form-control" id="what" style="width:100%" rows="5"></textarea>                        
                        </div>  
                        </div>

                    </fieldset>                    

                <div class="form-group">
                    <input class="button" type="submit" value="Continue" id="submit" onClick="return checkSelected()">
                </div>

          </form>

        </div>
      </div>
</main>



<script>

function checkSelected(){

var done = doneYesNo();
    console.log(done);
    
if (done == false){
    $('#error-summary').show();
    $('#error-summary').focus();
    return false;
}
else{
    $('#error-summary').hide();        
    return true;
}
}
    
function doneYesNo(){

// Nothing selected
if(!document.getElementById('done-yes').checked && !document.getElementById('done-no').checked){            
    $('#done-error-link').show();
    $('#done-error').show();
    $('#done-yes-no').addClass('error');
    $('#what-error-link').hide();
    $('#what-error').hide();
    $('#what-panel').removeClass('error');
    return false;
}
else if(document.getElementById('done-no').checked && document.getElementById('what').value == ""){
    $('#done-error-link').hide();
    $('#done-error').hide();
    $('#done-yes-no').removeClass('error');        
    $('#what-error-link').show();
    $('#what-error').show();
    $('#what-panel').addClass('error');
    return false;
}
else{
    $('#done-error-link').hide();
    $('#done-error').hide();
    $('#done-yes-no').removeClass('error');        
    $('#what-error-link').hide();
    $('#what-error').hide();
    $('#what-panel').removeClass('error');
    return true;
}
}
    

</script>

{% endblock %}